(TROJail-test) adminn@adminn:/data1/TROJail$ bash run.sh
[2026-02-01 23:10:53] Starting env_llm on port 8001...
[2026-02-01 23:10:53] Starting judger_llm on port 8002...
[2026-02-01 23:10:53] Waiting for vLLM servers to be ready...
[2026-02-01 23:10:53] Both vLLM servers are ready!
[2026-02-01 23:10:53] Starting training: train_demo...
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
/data1/hhc/miniconda3/envs/TROJail-test/lib/python3.12/site-packages/gym_sokoban/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
INFO 02-01 23:11:02 [__init__.py:239] Automatically detected platform cuda.
/data1/hhc/miniconda3/envs/TROJail-test/lib/python3.12/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In '_7_jailbreak.yaml': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
Error executing job with overrides: ['model_path=./models/Qwen2.5-3B-Instruct', 'env_llm.model_path=./models/Mistral-7B-Instruct-v0.3', 'judger_llm.model_path=./models/HarmBench-Mistral-7b-val-cls', 'env_llm.base_url=http://localhost:8001/v1', 'judger_llm.base_url=http://localhost:8002/v1', 'algorithm.heuristic_process_adv_lambda=0.1', 'experiment_name=train_demo', 'trainer.total_training_steps=260', 'trainer.test_freq=10', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.actor.optim.lr_warmup_steps=20', 'actor_rollout_ref.actor.use_kl_loss=True', 'actor_rollout_ref.actor.kl_loss_coef=0.01', 'actor_rollout_ref.actor.kl_loss_type=low_var_kl', 'actor_rollout_ref.actor.entropy_coeff=0.01', '+actor_rollout_ref.actor.fsdp_config.model_dtype=bfloat16']
Traceback (most recent call last):
  File "/data1/TROJail/train.py", line 159, in main
    config = add_dependency_and_validate_config(config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/TROJail/train.py", line 139, in add_dependency_and_validate_config
    assert len(str(config.system.CUDA_VISIBLE_DEVICES).split(',')) == config.trainer.n_gpus_per_node, \
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: CUDA_VISIBLE_DEVICES (0) must have the same number of GPUs as n_gpus_per_node (2)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[2026-02-01 23:11:05] Training train_demo finished.
[2026-02-01 23:11:05] Killing vLLM servers...
vLLM servers stopped.
